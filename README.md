# Content Security Policy Lab

### Описание

Небольшая лабораторная работа по настройке Content Security Policy.

### Задача:
Имеется веб-сервер, уязвимый к атакам типа Stored XSS (межсайтовый скриптинг с сохранением вредоносного кода). Необходимо выполнить митигацию (устранение уязвимости) путем настройки Content Security Policy (CSP) для предотвращения выполнения вредоносных скриптов. Настройка CSP должна быть реализована на уровне прокси-сервера, а также, при необходимости, внесены изменения в Python-код веб-сервиса для обеспечения дополнительной защиты.

### Цели:

1. Настроить CSP-заголовки на прокси-сервере для ограничения выполнения скриптов из ненадежных источников.

2. При необходимости модифицировать Python-код веб-сервиса для корректной обработки пользовательского ввода и предотвращения внедрения вредоносных скриптов.

3. Обеспечить совместимость CSP с функциональностью веб-сервиса: работа скрипта с анимацией, inline скрипт с текущим временем.

### Требования:

- CSP-политика должна быть настроена таким образом, чтобы блокировать выполнение inline-скриптов и скриптов из внешних источников, за исключением доверенных доменов.

- Прокси-сервер должен корректно передавать CSP-заголовки клиенту.

- Python-код должен быть проверен на наличие уязвимостей, связанных с неправильной обработкой пользовательского ввода, и при необходимости доработан.

### Ожидаемый результат:

Веб-сервер становится устойчивым к Stored XSS атакам благодаря корректно настроенной CSP-политике и улучшенной обработке пользовательского ввода.

Функциональность веб-сервиса сохраняется, а пользовательский опыт не ухудшается.

### Полезные ссылки

https://xakep.ru/2013/12/23/61798/ - Content Security Policy — опасная политика. Из минусов, статья устарела.

https://habr.com/ru/articles/757332/ - Подробная настройка Content Security Policy (CSP)

https://xakep.ru/2018/10/01/xss-csp-bypass/ - Разрешено все! Изучаем новую крутую технику обхода CSP

https://xakep.ru/2016/09/28/csp-tools/

https://xakep.ru/2024/01/22/htb-bookworm/ - HTB Bookworm. Эксплуатируем сложную XSS с байпасом CSP




